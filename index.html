<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scroll Verse Arena</title>
  <link href="style.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1 class="title">Scroll Verse Arena</h1>
    <p class="intro">Bienvenue dans le Scroll Verse Arena. Seuls les vrais connaisseurs des webtoons survivront aux épreuves.</p>
    <input type="text" id="pseudo" placeholder="Entre ton pseudo" />
    <button onclick="startGame()">Commencer</button>
    <div id="gameArea" style="display:none;">
  <p id="questionText"></p>
  <img id="questionImage" src="" style="max-width: 100%; display: none; margin-bottom: 1rem;" />
  <div id="optionsArea"></div>
  <input type="text" id="playerAnswer" placeholder="Ta réponse ici" style="display: none;" />
  <button id="submitBtn" onclick="submitAnswer()">Envoyer la réponse</button>
    </div>
  <script>
const questions = [
  {
    id: 1,
    type: "qcm",
    text: "Qui est le héros de Solo Leveling ?",
    options: ["Jin-Woo", "Bam", "Mori Jin", "Jin Mori"],
    answer: ["Jin-Woo"]
  },
  {
    id: 2,
    type: "image",
    text: "De quel manhwa vient ce personnage ?",
    image: "https://upload.wikimedia.org/wikipedia/en/7/79/Rai_Noblesse.jpg",
    options: ["Solo Leveling", "Noblesse", "UnOrdinary"],
    answer: ["Noblesse"]
  },
  {
    id: 3,
    type: "libre",
    text: "Quel est ton webtoon préféré ?",
    answer: []
  }
];

let currentQuestionIndex = 0;
let pseudo = "";

function startGame() {
  pseudo = document.getElementById("pseudo").value;
  if (!pseudo) {
    alert("Merci d’entrer un pseudo !");
    return;
  }
  localStorage.setItem("player", pseudo);

  // Commence à écouter les rounds
  waitForRound();
}

function waitForRound() {
  document.querySelector(".intro").style.display = "none";
  document.getElementById("gameArea").style.display = "block";
  document.getElementById("gameArea").innerHTML = `<p>En attente du prochain round...</p>`;

  setInterval(() => {
    const round = localStorage.getItem("startRound");
    if (round !== null && round !== "shown") {
      showQuestion(parseInt(round));
      localStorage.setItem("startRound", "shown");
    }
  }, 1000);
}

function showQuestion(index) {
  const q = questions[index];
  const image = document.getElementById("questionImage");
  const optionsArea = document.getElementById("optionsArea");

  document.getElementById("gameArea").innerHTML = `
    <p id="questionText">${q.text}</p>
    <img id="questionImage" src="${q.image || ""}" style="max-width: 100%; ${q.image ? "display:block;" : "display:none;"} margin-bottom: 1rem;" />
    <div id="optionsArea"></div>
    <input type="text" id="playerAnswer" placeholder="Ta réponse ici" ${q.type === "libre" ? "style='display:block;'" : "style='display:none;'"}>
    <button id="submitBtn" ${q.type === "libre" ? "style='display:inline-block;'" : "style='display:none;'"} onclick="submitAnswer()">Envoyer la réponse</button>
  `;

  if (q.type === "qcm" || q.type === "image") {
    const area = document.getElementById("optionsArea");
    q.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.innerText = opt;
      btn.onclick = () => {
        document.getElementById("playerAnswer").value = opt;
        submitAnswer();
      };
      area.appendChild(btn);
    });
  }
    }
    
function submitAnswer() {
  const answer = document.getElementById("playerAnswer").value;
  if (!answer) {
    alert("Tu dois répondre !");
    return;
  }

  const q = questions[currentQuestionIndex];
  const responses = JSON.parse(localStorage.getItem("responses") || "[]");
  responses.push({
    player: pseudo,
    question: q.text,
    answer: answer
  });
  localStorage.setItem("responses", JSON.stringify(responses));

  document.getElementById("gameArea").innerHTML = `
    <p>Merci ${pseudo} !<br />
    Ta réponse a été enregistrée.<br />
    <strong>Bonne réponse :</strong> ${q.answer.join(", ")}</p>
  `;
}
      </script> 
</body>
</html> 
